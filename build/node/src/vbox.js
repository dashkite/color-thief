"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.VBox = void 0;
var Type = _interopRequireWildcard(require("@dashkite/joy/type"));
var C = _interopRequireWildcard(require("./constants.js"));
var _histogram = require("./histogram.js");
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
var VBox;
exports.VBox = VBox = function () {
  // 3d color space box
  class VBox {
    constructor({
      r1: r11,
      r2: r21,
      g1: g11,
      g2: g21,
      b1: b11,
      b2: b21,
      histogram: histogram1
    }) {
      this.r1 = r11;
      this.r2 = r21;
      this.g1 = g11;
      this.g2 = g21;
      this.b1 = b11;
      this.b2 = b21;
      this.histogram = histogram1;
    }
    static create({
      r1,
      r2,
      g1,
      g2,
      b1,
      b2,
      histogram
    }) {
      return new VBox({
        r1,
        r2,
        g1,
        g2,
        b1,
        b2,
        histogram
      });
    }
    static fromPixels(pixels, histogram) {
      var b, b1, b2, g, g1, g2, l, len, pixel, r, r1, r2;
      r1 = g1 = b1 = 1e6;
      r2 = g2 = b2 = 0;
      for (l = 0, len = pixels.length; l < len; l++) {
        pixel = pixels[l];
        r = pixel[0] >> C.rshift;
        g = pixel[1] >> C.rshift;
        b = pixel[2] >> C.rshift;
        if (r < r1) {
          r1 = r;
        } else if (r > r2) {
          r2 = r;
        }
        if (g < g1) {
          g1 = g;
        } else if (g > g2) {
          g2 = g;
        }
        if (b < b1) {
          b1 = b;
        } else if (b > b2) {
          b2 = b;
        }
      }
      return VBox.create({
        r1,
        r2,
        g1,
        g2,
        b1,
        b2,
        histogram
      });
    }
    copy() {
      return VBox.create(this);
    }
    volume(force) {
      if (force === true || this._volume == null) {
        this._volume = (this.r2 - this.r1 + 1) * (this.g2 - this.g1 + 1) * (this.b2 - this.b1 + 1);
      }
      return this._volume;
    }
    count(force) {
      var count, i, index, j, k, l, m, n, ref, ref1, ref2, ref3, ref4, ref5;
      if (force === true || this._count == null) {
        count = 0;
        for (i = l = ref = this.r1, ref1 = this.r2; ref <= ref1 ? l <= ref1 : l >= ref1; i = ref <= ref1 ? ++l : --l) {
          if (this.r1 <= this.r2) {
            for (j = m = ref2 = this.g1, ref3 = this.g2; ref2 <= ref3 ? m <= ref3 : m >= ref3; j = ref2 <= ref3 ? ++m : --m) {
              if (this.g1 <= this.g2) {
                for (k = n = ref4 = this.b1, ref5 = this.b2; ref4 <= ref5 ? n <= ref5 : n >= ref5; k = ref4 <= ref5 ? ++n : --n) {
                  if (!(this.b1 <= this.b2)) {
                    continue;
                  }
                  index = (0, _histogram.getColorIndex)(i, j, k);
                  count += this.histogram[index] || 0;
                }
              }
            }
          }
        }
        this._count = count;
      }
      return this._count;
    }
    avg(force) {
      var bSum, gSum, i, index, j, k, l, m, mult, n, rSum, ref, ref1, ref2, ref3, ref4, ref5, total, value;
      if (force === true || this._avg == null) {
        total = rSum = gSum = bSum = 0;
        mult = 1 << 8 - C.sigbits;
        for (i = l = ref = this.r1, ref1 = this.r2; ref <= ref1 ? l <= ref1 : l >= ref1; i = ref <= ref1 ? ++l : --l) {
          if (this.r1 <= this.r2) {
            for (j = m = ref2 = this.g1, ref3 = this.g2; ref2 <= ref3 ? m <= ref3 : m >= ref3; j = ref2 <= ref3 ? ++m : --m) {
              if (this.g1 <= this.g2) {
                for (k = n = ref4 = this.b1, ref5 = this.b2; ref4 <= ref5 ? n <= ref5 : n >= ref5; k = ref4 <= ref5 ? ++n : --n) {
                  if (!(this.b1 <= this.b2)) {
                    continue;
                  }
                  index = (0, _histogram.getColorIndex)(i, j, k);
                  value = this.histogram[index] || 0;
                  total += value;
                  rSum += value * (i + 0.5) * mult;
                  gSum += value * (j + 0.5) * mult;
                  bSum += value * (k + 0.5) * mult;
                }
              }
            }
          }
        }
        if (total) {
          this._avg = [~~(rSum / total), ~~(gSum / total), ~~(bSum / total)];
        } else {
          this._avg = [~~(mult * (this.r1 + this.r2 + 1) / 2), ~~(mult * (this.g1 + this.g2 + 1) / 2), ~~(mult * (this.b1 + this.b2 + 1) / 2)];
        }
      }
      return this._avg;
    }
    contains(pixel) {
      var b, g, r;
      r = pixel[0] >> C.rshift;
      g = pixel[1] >> C.rshift;
      b = pixel[2] >> C.rshift;
      return this.r1 <= r && r <= this.r2 && this.g1 <= g && g <= this.g2 && this.b1 <= b && b <= this.b2;
    }
  }
  ;
  VBox.isType = Type.isType(VBox);
  return VBox;
}.call(void 0);
//# sourceMappingURL=data:application/json;base64,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QUFLLENBQUMsQ0FBRCxDQUFMLElBQVksQ0FBQyxDQUFDLE1BQUE7TUFDbEIsQ0FBQSxHQUFJLEtBQUssQ0FBQyxDQUFELENBQUwsSUFBWSxDQUFDLENBQUMsTUFBQTtNQUNsQixDQUFBLEdBQUksS0FBSyxDQUFDLENBQUQsQ0FBTCxJQUFZLENBQUMsQ0FBQyxNQUFBO01BRWxCLE9BQUMsSUFBQyxDQUFBLEVBQUQsSUFBTyxDQUFQLElBQU8sQ0FBUCxJQUFZLElBQUMsQ0FBQSxFQUFkLElBQXNCLElBQUMsQ0FBQSxFQUFELElBQU8sQ0FBUCxJQUFPLENBQVAsSUFBWSxJQUFDLENBQWQsRUFBckIsSUFBMkMsSUFBQyxDQUFBLEVBQUQsSUFBTyxDQUFQLElBQU8sQ0FBUCxJQUFZLElBQUMsQ0FBZCxFQUFBO0lBTGxDO0VBNUZaO0VBQUE7RUFNRSxJQUFDLENBQUEsTUFBRCxHQUFTLElBQUksQ0FBQyxNQUFMLENBQVksSUFBWixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgVHlwZSBmcm9tIFwiQGRhc2hraXRlL2pveS90eXBlXCJcbmltcG9ydCAqIGFzIEMgZnJvbSBcIi4vY29uc3RhbnRzXCJcbmltcG9ydCB7IGdldENvbG9ySW5kZXggfSBmcm9tIFwiLi9oaXN0b2dyYW1cIlxuXG5cbiMgM2QgY29sb3Igc3BhY2UgYm94XG5jbGFzcyBWQm94XG4gIGNvbnN0cnVjdG9yOiAoeyBAcjEsIEByMiwgQGcxLCBAZzIsIEBiMSwgQGIyLCBAaGlzdG9ncmFtIH0pIC0+XG5cbiAgQGNyZWF0ZTogKHsgcjEsIHIyLCBnMSwgZzIsIGIxLCBiMiwgaGlzdG9ncmFtIH0pIC0+XG4gICAgbmV3IFZCb3ggeyByMSwgcjIsIGcxLCBnMiwgYjEsIGIyLCBoaXN0b2dyYW0gfVxuXG4gIEBpc1R5cGU6IFR5cGUuaXNUeXBlIEBcblxuICBAZnJvbVBpeGVsczogKCBwaXhlbHMsIGhpc3RvZ3JhbSApIC0+XG4gICAgcjEgPSBnMSA9IGIxID0gMWU2XG4gICAgcjIgPSBnMiA9IGIyID0gMFxuXG4gICAgZm9yIHBpeGVsIGluIHBpeGVsc1xuICAgICAgciA9IHBpeGVsWzBdID4+IEMucnNoaWZ0XG4gICAgICBnID0gcGl4ZWxbMV0gPj4gQy5yc2hpZnRcbiAgICAgIGIgPSBwaXhlbFsyXSA+PiBDLnJzaGlmdFxuXG4gICAgICBpZiByIDwgcjFcbiAgICAgICAgcjEgPSByXG4gICAgICBlbHNlIGlmIHIgPiByMlxuICAgICAgICByMiA9IHJcblxuICAgICAgaWYgZyA8IGcxXG4gICAgICAgIGcxID0gZ1xuICAgICAgZWxzZSBpZiBnID4gZzJcbiAgICAgICAgZzIgPSBnXG5cbiAgICAgIGlmIGIgPCBiMVxuICAgICAgICBiMSA9IGJcbiAgICAgIGVsc2UgaWYgYiA+IGIyXG4gICAgICAgIGIyID0gYlxuXG4gICAgVkJveC5jcmVhdGUgeyByMSwgcjIsIGcxLCBnMiwgYjEsIGIyLCBoaXN0b2dyYW0gfVxuXG5cbiAgY29weTogLT4gVkJveC5jcmVhdGUgQFxuXG4gIHZvbHVtZTogKCBmb3JjZSApIC0+XG4gICAgaWYgZm9yY2UgPT0gdHJ1ZSB8fCAhQF92b2x1bWU/XG4gICAgICBAX3ZvbHVtZSA9XG4gICAgICAgIChAcjIgLSBAcjEgKyAxKSAqIFxuICAgICAgICAoQGcyIC0gQGcxICsgMSkgKiBcbiAgICAgICAgKEBiMiAtIEBiMSArIDEpXG5cbiAgICBAX3ZvbHVtZVxuXG5cbiAgY291bnQ6ICggZm9yY2UgKSAtPlxuICAgIGlmIGZvcmNlID09IHRydWUgfHwgIUBfY291bnQ/XG4gICAgICBjb3VudCA9IDBcbiAgICAgIGZvciBpIGluIFsgQHIxIC4uIEByMiBdIHdoZW4gQHIxIDw9IEByMlxuICAgICAgICBmb3IgaiBpbiBbIEBnMSAuLiBAZzIgXSB3aGVuIEBnMSA8PSBAZzJcbiAgICAgICAgICBmb3IgayBpbiBbIEBiMSAuLiBAYjIgXSB3aGVuIEBiMSA8PSBAYjJcbiAgICAgICAgICAgIGluZGV4ID0gZ2V0Q29sb3JJbmRleCBpLCBqLCBrXG4gICAgICAgICAgICBjb3VudCArPSBAaGlzdG9ncmFtWyBpbmRleCBdIHx8IDBcblxuICAgICAgQF9jb3VudCA9IGNvdW50XG4gICAgXG4gICAgQF9jb3VudFxuXG5cbiAgYXZnOiAoIGZvcmNlICkgLT5cbiAgICBpZiBmb3JjZSA9PSB0cnVlIHx8ICFAX2F2Zz9cbiAgICAgIHRvdGFsID0gclN1bSA9IGdTdW0gPSBiU3VtID0gMFxuICAgICAgbXVsdCA9IDEgPDwgKCA4IC0gQy5zaWdiaXRzIClcblxuICAgICAgZm9yIGkgaW4gWyBAcjEgLi4gQHIyIF0gd2hlbiBAcjEgPD0gQHIyXG4gICAgICAgIGZvciBqIGluIFsgQGcxIC4uIEBnMiBdIHdoZW4gQGcxIDw9IEBnMlxuICAgICAgICAgIGZvciBrIGluIFsgQGIxIC4uIEBiMiBdIHdoZW4gQGIxIDw9IEBiMlxuICAgICAgICAgICAgaW5kZXggPSBnZXRDb2xvckluZGV4IGksIGosIGtcbiAgICAgICAgICAgIHZhbHVlID0gQGhpc3RvZ3JhbVsgaW5kZXggXSB8fCAwXG4gICAgICAgICAgICB0b3RhbCArPSB2YWx1ZVxuICAgICAgICAgICAgclN1bSArPSAodmFsdWUgKiAoaSArIDAuNSkgKiBtdWx0KVxuICAgICAgICAgICAgZ1N1bSArPSAodmFsdWUgKiAoaiArIDAuNSkgKiBtdWx0KVxuICAgICAgICAgICAgYlN1bSArPSAodmFsdWUgKiAoayArIDAuNSkgKiBtdWx0KVxuXG4gICAgICBpZiB0b3RhbFxuICAgICAgICBAX2F2ZyA9IFsgXG4gICAgICAgICAgfn4oclN1bSAvIHRvdGFsKSwgXG4gICAgICAgICAgfn4oZ1N1bSAvIHRvdGFsKSwgXG4gICAgICAgICAgfn4oYlN1bSAvIHRvdGFsKSBcbiAgICAgICAgXVxuICAgICAgZWxzZVxuICAgICAgICBAX2F2ZyA9IFtcbiAgICAgICAgICB+fihtdWx0ICogKEByMSArIEByMiArIDEpIC8gMiksXG4gICAgICAgICAgfn4obXVsdCAqIChAZzEgKyBAZzIgKyAxKSAvIDIpLFxuICAgICAgICAgIH5+KG11bHQgKiAoQGIxICsgQGIyICsgMSkgLyAyKVxuICAgICAgICBdXG5cbiAgICBAX2F2Z1xuXG4gICBcbiAgY29udGFpbnM6ICggcGl4ZWwgKSAtPlxuICAgIHIgPSBwaXhlbFswXSA+PiBDLnJzaGlmdFxuICAgIGcgPSBwaXhlbFsxXSA+PiBDLnJzaGlmdFxuICAgIGIgPSBwaXhlbFsyXSA+PiBDLnJzaGlmdFxuXG4gICAgKEByMSA8PSByIDw9IEByMikgJiYgKEBnMSA8PSBnIDw9IEBnMikgJiYgKEBiMSA8PSBiIDw9IEBiMilcblxuXG5leHBvcnQgeyBWQm94IH0iXSwic291cmNlUm9vdCI6IiJ9
//# sourceURL=src/vbox.coffee